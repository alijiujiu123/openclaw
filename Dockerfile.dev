# OpenClaw Docker 运行环境
# 使用预构建的镜像，挂载源代码进行开发

FROM node:22-alpine

# Install runtime dependencies
RUN apk add --no-cache \
    git \
    curl \
    bash \
    tzdata \
    ca-certificates \
    vim

# Install pnpm
RUN npm install -g pnpm

# Create app directory
WORKDIR /app

# Create non-root user
RUN addgroup -g 1001 -S nodejs && \
    adduser -S openclaw -u 1001 -G nodejs

# Switch to development user
USER openclaw

# Set up environment
ENV HOME=/home/openclaw
ENV PATH=/app/node_modules/.bin:$PATH
ENV NODE_OPTIONS=--max-old-space-size=4096

# Expose gateway port
EXPOSE 18789

# Default command: keep container running for development
CMD ["/bin/sh"]
